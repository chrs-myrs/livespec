---
implements: specs/3-behaviors/slash-command-generation.spec.md
phase: utilities
---

# Generate Slash Commands

**Purpose:** Generate Claude Code slash commands for all LiveSpec utility prompts in `.claude/commands/livespec/` namespace.

**When to use:** During Phase 0 setup, after updating prompts, when commands missing or stale, or manually via `/livespec/generate-commands`.

---

## Instructions for AI Agent

You are generating discoverable slash commands for LiveSpec utilities. Users can invoke these via Claude Code's `/` autocomplete.

### Step 1: Read Command Template

```bash
cat .livespec/templates/commands/utility-command.md
```

**Template structure:**
- Frontmatter: description, generated_by, generated_at, prompt, parameters (if applicable)
- Body: Title, "Use [prompt-path]" instruction
- What/When sections
- Parameter documentation (if applicable)
- Customization footer

### Step 2: Read Prompt Registry

```bash
cat specs/3-behaviors/prompts/registry.spec.md
```

**Extract utility prompts:**
- Prompt name
- Spec path (to get description)
- Prompt path (dist/prompts/utils/)
- Output location (for context)

### Step 3: Define Command Mappings

**Essential Commands (8):**

1. **complete-session**
   - Prompt: `dist/prompts/utils/complete-session.md`
   - Description: "End-of-session analysis with compliance and learning capture"
   - Parameters: none

2. **rebuild-agents**
   - Prompt: `dist/prompts/4-evolve/4d-regenerate-agents.md`
   - Description: "Rebuild AGENTS.md and context tree from workspace specs"
   - Parameters: none

3. **refine-workspace**
   - Prompt: `dist/prompts/utils/reorganize-workspace.md`
   - Description: "Optimize workspace structure based on usage patterns"
   - Parameters: none

4. **suggest-improvements**
   - Prompt: `dist/prompts/utils/suggest-improvements.md`
   - Description: "Strategic improvement recommendations from accumulated data"
   - Parameters:
     - `scope`: all (default), context, registries, validation

5. **health-report**
   - Prompt: `dist/prompts/utils/run-health-report.md`
   - Description: "Comprehensive project health check with status indicators"
   - Parameters: none

6. **validate**
   - Prompt: `dist/prompts/utils/validate-project.md`
   - Description: "Run project validation checks"
   - Parameters: none

7. **audit**
   - Prompt: Multiple audit prompts (router logic)
   - Description: "Run quality audits on project specifications"
   - Parameters:
     - `type`: minimalism, context, coverage, workspace-specs, workspace-scope, all (default)
   - Router logic:
     - `minimalism` ‚Üí `audit-msl-minimalism.md`
     - `context` ‚Üí `audit-context-compression.md`
     - `coverage` ‚Üí `audit-spec-coverage.md`
     - `workspace-specs` ‚Üí `audit-workspace-specs.md`
     - `workspace-scope` ‚Üí `audit-workspace-scope.md`
     - `all` ‚Üí Run all 5 audits sequentially

8. **next-steps**
   - Prompt: `dist/prompts/utils/next-steps.md`
   - Description: "Workflow orchestration and phase navigation"
   - Parameters: none

**Optional Commands (3):**

9. **run-spike**
   - Prompt: `dist/prompts/utils/run-spike.md`
   - Description: "Time-boxed technical exploration"
   - Parameters:
     - `topic`: (required, free text)

10. **analyze-failure**
    - Prompt: `dist/prompts/utils/analyze-failure.md`
    - Description: "Forensic analysis when LiveSpec adoption fails"
    - Parameters: none

11. **upgrade**
    - Prompt: `dist/prompts/utils/upgrade-methodology.md`
    - Description: "Migrate to new LiveSpec version"
    - Parameters: none

### Step 4: Create Command Directory

```bash
mkdir -p .claude/commands/livespec
```

### Step 5: Generate Each Command

**For each of the 11 commands:**

**5a. Check if command exists:**
```bash
test -f .claude/commands/livespec/[command-name].md
```

**5b. Check for customization:**
```bash
# If file exists, check for generated_by field
grep "^generated_by: livespec$" .claude/commands/livespec/[command-name].md
```

- **Missing `generated_by`** = User customized ‚Üí Ask before overwriting
- **Has `generated_by`** = Safe to regenerate

**5c. Generate command file:**

Use template structure:

```markdown
---
description: [One-line description from mapping]
generated_by: livespec
generated_at: [YYYY-MM-DD]
prompt: [prompt-path from mapping]
supports_parameters: [true/false]
parameters:
  - name: [param-name]
    values: [array of valid values]
    default: [default value]
---

# [Command Title]

Use `[prompt-path]` [with parameters: {{parameters}}]

**What this does:** [Description from mapping]

**When to use:** [Context from prompt spec]

[If parameters exist:]
**Parameters:**
- `[param-name]`: [Description] ([valid values])
  - Default: [default]

---

*This slash command was generated by LiveSpec. To customize, remove the `generated_by` field from frontmatter.*
```

**Special case for `audit` command (router):**

```markdown
---
description: Run quality audits on project specifications
generated_by: livespec
generated_at: [YYYY-MM-DD]
prompt: Multiple audit prompts (routed by type parameter)
supports_parameters: true
parameters:
  - name: type
    values: [minimalism, context, coverage, workspace-specs, workspace-scope, all]
    default: all
---

# Audit Project

Run quality audits on LiveSpec project specifications.

**What this does:** Executes audit prompts based on type parameter, checking specifications for quality issues.

**When to use:** Monthly reviews, before releases, when specs feel bloated, or when investigating project health issues.

**Parameters:**
- `type`: Audit type to run (minimalism, context, coverage, workspace-specs, workspace-scope, all)
  - `minimalism` - Check specs for over-specification (MSL principles)
  - `context` - Analyze context compression effectiveness
  - `coverage` - Verify all permanent files have specs
  - `workspace-specs` - Detect bloat/redundancy in workspace specs
  - `workspace-scope` - Verify workspace scope appropriateness
  - `all` (default) - Run all 5 audit types sequentially

**Router logic:**
- `minimalism` ‚Üí Use `dist/prompts/utils/audit-msl-minimalism.md`
- `context` ‚Üí Use `dist/prompts/utils/audit-context-compression.md`
- `coverage` ‚Üí Use `dist/prompts/utils/audit-spec-coverage.md`
- `workspace-specs` ‚Üí Use `dist/prompts/utils/audit-workspace-specs.md`
- `workspace-scope` ‚Üí Use `dist/prompts/utils/audit-workspace-scope.md`
- `all` ‚Üí Execute all 5 prompts in sequence, aggregate results

---

*This slash command was generated by LiveSpec. To customize, remove the `generated_by` field from frontmatter.*
```

**5d. Track generation:**
- Created: New command generated
- Updated: Existing command regenerated (had `generated_by`)
- Skipped: Customized command (missing `generated_by`)

### Step 6: Handle Customized Commands

**If command exists without `generated_by` field:**

1. Show diff between current and proposed
2. Ask user:
   - Overwrite with new version (lose customizations)
   - Keep current version (skip regeneration)
   - Review specific changes (show full diff)

**Prompt format:**
```
Found customized command: .claude/commands/livespec/[name].md

This command was customized (missing 'generated_by' field).
Regenerating will overwrite your customizations.

Options:
1. Keep current (skip regeneration)
2. Overwrite with new version (lose customizations)
3. Show diff (review changes)

What would you like to do?
```

### Step 7: Validation

**After generation, verify:**

```bash
# All 11 commands should exist
ls -1 .claude/commands/livespec/*.md | wc -l
# Expected: 11

# Check generated commands have metadata
grep -l "^generated_by: livespec$" .claude/commands/livespec/*.md | wc -l
# Expected: [count of non-customized commands]

# Verify prompt paths exist
for cmd in .claude/commands/livespec/*.md; do
  prompt=$(grep "^prompt:" "$cmd" | cut -d' ' -f2)
  if [ "$prompt" != "Multiple" ]; then
    test -f "$prompt" || echo "Missing: $prompt (referenced by $cmd)"
  fi
done
```

### Step 8: Generate Report

**Format (concise):**

```markdown
# Slash Command Generation Report

**Date:** YYYY-MM-DD
**Namespace:** .claude/commands/livespec/

---

## Summary

| Action | Count | Commands |
|--------|-------|----------|
| ‚úÖ Created | X | [list] |
| üîÑ Updated | X | [list] |
| ‚è≠Ô∏è Skipped (customized) | X | [list] |

**Total commands:** 11/11

---

## Details

### ‚úÖ Created (X)

- **complete-session** ‚Üí dist/prompts/utils/complete-session.md
- **rebuild-agents** ‚Üí dist/prompts/4-evolve/4d-regenerate-agents.md
- ...

### üîÑ Updated (X)

- **suggest-improvements** (was stale, regenerated from prompt)
- ...

### ‚è≠Ô∏è Skipped (X)

- **audit** (customized by user, kept existing version)
- ...

---

## Usage

Commands available via Claude Code slash autocomplete:

**Session-Level:**
- `/livespec/complete-session` - End session with analysis

**Context-Level:**
- `/livespec/rebuild-agents` - Regenerate from specs
- `/livespec/refine-workspace` - Optimize structure

**Strategic-Level:**
- `/livespec/suggest-improvements [scope]` - Get recommendations
  - Example: `/livespec/suggest-improvements context`

**Diagnostic-Level:**
- `/livespec/health-report` - Check project health

**Utilities:**
- `/livespec/validate` - Run validation
- `/livespec/audit [type]` - Run audits
  - Example: `/livespec/audit minimalism`
- `/livespec/next-steps` - Navigate workflow

**Special:**
- `/livespec/run-spike [topic]` - Explore topic
  - Example: `/livespec/run-spike authentication strategies`
- `/livespec/analyze-failure` - Analyze adoption issues
- `/livespec/upgrade` - Migrate to new version

---

## Validation

- [X] All 11 commands exist
- [X] Generated commands have metadata
- [X] Prompt paths valid
- [X] Parameter documentation present (where applicable)
- [X] Router logic documented (audit command)

---

## Next Steps

1. Test command discovery: Type `/livespec/` in Claude Code
2. Verify autocomplete shows all 11 commands
3. Test parameterized commands: `/livespec/audit minimalism`
4. Customize if needed (remove `generated_by` to prevent regeneration)
```

---

## When NOT to Generate

**Skip if:**
- Commands recently generated and unchanged
- User in middle of customizing commands (wait for completion)
- Project not using Claude Code (slash commands not applicable)

**Generate when:**
- Phase 0 setup (0a-quick-start or 0b-customize-workspace)
- Prompts updated (new utilities added)
- Validation detects missing commands
- User requests explicit regeneration

---

## Integration Points

**Phase 0 Setup:**
- 0a-quick-start.md includes: "Generate slash commands (use generate-slash-commands.md)"
- 0b-customize-workspace.md includes: "Generate slash commands (use generate-slash-commands.md)"

**Validation:**
- validate-project.md checks: All 11 commands exist, descriptions match registry, prompt paths valid

**Manual Invocation:**
- User can run: "Use dist/prompts/utils/generate-slash-commands.md"
- Or via slash command (once generated): `/livespec/generate-commands`

---

## Output Quality Checklist

Before completing:
- [ ] All 11 commands generated or accounted for
- [ ] Customized commands detected and user prompted
- [ ] Generated commands have complete frontmatter
- [ ] Parameter documentation present (where applicable)
- [ ] Router logic documented (audit command)
- [ ] Validation passed
- [ ] Report shows clear summary
- [ ] Usage examples provided

---

**Remember:** Slash commands make LiveSpec utilities discoverable. Users can find prompts via `/` autocomplete instead of navigating `.livespec/` structure. Namespace prevents pollution of project root commands.
