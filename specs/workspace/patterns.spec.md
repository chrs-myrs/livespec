---
applies_to:
  - all_projects
  - all_specifications
criticality: IMPORTANT
failure_mode: Inconsistent patterns make LiveSpec harder to understand and maintain
governed-by:
  - .livespec/standard/metaspecs/workspace.spec.md
---

# LiveSpec Development Patterns

## Requirements
- LiveSpec follows strict patterns: MSL format for all specs (.spec.md extension with four sections), British English for user docs, phase-letter naming for prompts (0a-), one spec per behavior, workspace/strategy separation in folder structure, and YAML frontmatter declaring specification dependencies.
  - All .spec.md files pass MSL format validation
  - Documentation uses British spellings (synchronisation, behaviour)
  - Prompt files follow [0-4][a-z]-*.md pattern
  - Each behavior has single dedicated spec file
  - specs/workspace/ contains only portable development methodology
  - specs/strategy/ contains only product-specific technical decisions
  - Specifications declare dependencies via YAML frontmatter
  - Strategy files stay minimal (single file <100 lines, split files <50 lines each)
  - AGENTS.md references specs/workspace/workspace-agent.spec.md in frontmatter
  - Agent integration behaviors defined in specs/workspace/livespec.spec.md
  - Regeneration prompt exists at prompts/4-evolve/4d-regenerate-agents.md
  - Extracted specs use confidence markers when appropriate (LOW/MEDIUM confidence)
  - Extracted specs promoted to VALIDATED status after human review

## Folder Organization

### specs/workspace/ - Development Process (Portable)
**Contains:** How we develop ANY project using LiveSpec methodology

**Examples:**
- constitution.spec.md - Governance (MSL minimalism, dogfooding)
- patterns.spec.md - Conventions (naming, format, structure)
- workflows.spec.md - Process (when phases run, how to evolve)

**Test:** "Could I copy this spec to a different project?" → YES = workspace

### specs/strategy/ - Technical Approach (Product-Specific)
**Contains:** How we solve THIS SPECIFIC problem technically

**Examples:**
- architecture.spec.md - System structure, components, approach
- [For complex projects, can split into]:
  - integration.spec.md - APIs, messaging, service communication
  - data.spec.md - Storage, caching, data flow
  - security.spec.md - Authentication, authorization, encryption
  - deployment.spec.md - Infrastructure, CI/CD, environments

**Test:** "Could I copy this spec to a different project?" → NO = strategy

**Scaling guidance:**
- Simple projects: Single `strategy/architecture.spec.md` file
- When architecture.spec.md exceeds ~100 lines: Split by concern
- Each strategy file stays minimal (<50 lines per MSL)

### specs/behaviors/ - Observable Outcomes
**Contains:** What the system must do (user-facing behaviors)

### specs/contracts/ - Interface Definitions
**Contains:** API contracts, data formats (YAML, JSON, OpenAPI)

## Distribution Pattern

### Canonical Source: dist/
- **dist/prompts/** - Canonical framework prompts (source of truth)
- **dist/templates/** - Canonical templates
- **dist/standard/** - MSL metaspecs and conventions
- **dist/guides/** - Usage guides

### Project Use: Symlinks + Generated
- **prompts/** - Symlinks to dist/prompts/* (easy access, no duplication)
- **prompts/generated/** - Project-specific generated prompts (committed)
  - Generated by: prompts/utils/generate-*.md
  - Examples: self-improve.md, internalise-learnings.md
  - Customized to project PURPOSE, principles, and spec structure
- **.livespec/** - Copied from dist/ on project setup (gitignored)

**Why symlinks:**
- Single source of truth (dist/ is canonical)
- No drift between prompts/ and dist/prompts/
- Updates to dist/ immediately visible in prompts/
- Clear separation: framework (symlinked) vs project-specific (generated/)

**Why generated prompts are committed:**
- Tailored to specific project context
- Reference actual PURPOSE.md and specs/
- Should be versioned with project
- Regenerated when project fundamentals change

## Specification Patterns

### MSL Format
- All specs follow MSL (Markdown Specification Language) from github.com/chrs-myrs/msl-specification
- Required: Title and `## Requirements` section
- LiveSpec custom frontmatter: `criticality` (CRITICAL/IMPORTANT), `failure_mode`

### Naming Conventions
- Prompts: [0-4][a-z]-descriptive-name.md (e.g., 1a-design-architecture.md)
- Specs: descriptive-name.spec.md (matches prompt or behavior)
- British English for user documentation (synchronisation, behaviour)
- American English for code elements

### Dependency Traceability

**Prompts use `implements:` to reference defining specifications:**
```yaml
---
implements: specs/behaviors/prompts/1a-design-architecture.spec.md
---
```

**Specs use `governed-by:` to reference constraining metaspecs:**
```yaml
---
governed-by:
  - .livespec/standard/metaspecs/behavior.spec.md
---
```

**Other dependency fields for specs:**
- `derives-from:` - Parent specs this is based on
- `satisfies:` - Requirements this fulfills
- `supports:` - What this spec enables
- `applies_to:` - Scope (for workspace specs)

### Confidence Markers for Extracted Specifications

When extracting specs from code (Phase 4b), mark low-confidence extractions:

**Frontmatter metadata:**
- `extracted_from` - Source files (traceability)
- `extracted_date` - ISO timestamp (when extracted)
- `confidence` - LOW | MEDIUM (omit if HIGH)
- `requires_validation` - Boolean flag for review queue
- `extraction_reason` - Why low confidence (helps validation)

**Validation markers:**
- `[?]` - Criterion needs validation
- `[✓]` - Criterion validated
- `⚠️` - Entire spec flagged for review

**Lifecycle states:**
- EXTRACTED - Generated from code, needs validation
- REVIEWED - Human examined, corrections made
- VALIDATED - Promoted to standard spec (markers removed)

**Example frontmatter:**
```yaml
---
extracted_from:
  - src/auth/oauth.py
  - src/auth/session.py
extracted_date: 2025-10-06
confidence: LOW
requires_validation: true
extraction_reason: "Inferred from implementation, no tests found"
---
```

**Promotion:** When validated, remove extraction metadata, add standard frontmatter (derives_from, satisfies, etc.)
